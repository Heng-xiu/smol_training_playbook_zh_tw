## [基礎設施 - 無名英雄](https://huggingfacetb-smol-training-playbook.hf.space/#infrastructure---the-unsung-hero)

現在你已經知道了我們所知道的關於模型創建和訓練的一切,讓我們來解決可以成就或破壞你的專案(和你的銀行帳戶)的關鍵但_被低估_的組件:基礎設施。無論你專注於框架、架構還是資料策劃,理解基礎設施基礎知識有助於識別訓練瓶頸、優化並行策略以及除錯輸送量問題。(至少,它改善了與基礎設施團隊的溝通 😉)。
大多數訓練模型的人非常關心架構和資料,但很少有人理解基礎設施細節。基礎設施專業知識通常存在於框架開發者和叢集工程師中,並被其他人視為已解決的問題:租用一些 GPU,安裝 PyTorch,你就可以開始了。我們在 384 個 H100 上訓練 SmolLM3 近一個月,處理了總共 11 兆 tokens...這不是一個順利的旅程!在那段時間裡,我們處理了節點故障、儲存問題和執行重新啟動(參見[訓練馬拉松部分](https://huggingfacetb-smol-training-playbook.hf.space/#the-training-marathon))。你需要有良好的應急計劃和策略來為這些問題做準備,並保持訓練順利和低維護。
本章旨在彌合這一知識差距。將其視為硬體層的實用指南,專注於對訓練重要的問題。(注意:每個小節都以 TL;DR 開頭,因此你可以選擇你的深度級別。)
前兩節處理硬體如何工作的基礎知識:GPU 實際上由什麼組成?記憶體層次結構如何工作?CPU 和 GPU 如何通訊?我們還將介紹在獲取 GPU 時需要考慮的事項,以及在承諾長期訓練執行之前如何測試它們。最重要的是,我們將在每一步向你展示如何自己衡量和診斷這些系統。接下來的部分更加應用,我們將看到如何使你的基礎設施對失敗具有彈性,以及如何最大程度地優化你的訓練輸送量。
本章的遊戲名稱是找到並修復瓶頸!
將此視為建立你對為什麼某些設計決策很重要的直覺。當你理解你的模型的啟動需要流經多個快取層級,每個層級都有不同的頻寬和延遲特性時,你自然會開始思考如何構建你的訓練以最小化資料移動。當你看到節點間通訊比節點內慢幾個數量級時,你會理解為什麼並行策略如此重要。
讓我們從打開 GPU 並看看裡面有什麼開始。

